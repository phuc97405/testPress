
<div class="mt-4">
  <div>
    <a href="/me/stored/courses">Danh sách khóa học</a>
    <h3>Khóa học đã xóa</h3>
  </div>
  <table class="table">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Tên khóa học</th>
        <th scope="col">Trình độ</th>
        <th scope="col" colspan="2">Thời gian tạo</th>
      </tr>
    </thead>
    <tbody>
      {{#each courses}}
        <tr>
          <th scope="row">{{sum @index 1}}</th>
          <td>{{this.name}}</td>
          <td>{{this.level}}</td>
          <td>{{this.createdAt}}</td>
          <td>
            <a href="" class="btn btn-link btn-restore" data-id="{{this._id}}">Khôi phục</a>
            <a href=""
              class="btn btn-link"
              data-bs-toggle="modal"
              data-bs-target="#delete-course-modal"
              data-id="{{this._id}}"
            >Xóa Vĩnh Viễn</a>
          </td>
        </tr>
        {{else}}
          <td colspan="5" class="text-center">
            Thùng rác trống.
            <a href="/me/stored/courses">Danh sách khóa học</a>
          </td>
      {{/each}}
    </tbody>
  </table>

</div>


<form id="restore-course-form" name="restore-course-form" method="POST"/>
<form id="delete-course-form" name="delete-course-form" method="POST"/>

<script>
  document.addEventListener('DOMContentLoaded', function(){
    var courseId;
    var deleteForm = 
    {{!-- getElementById('delete-course-form'); --}}
    document.forms['delete-course-form'];
    var restoreForm =
     {{!-- getElementById('restore-course-form'); --}}
    document.forms['restore-course-form'];
    var btnDeleteCourse = document.getElementById('btn-delete-course');
    var restoreBtn = $('.btn-restore');

     //when dialog confirm clicked
        $('#delete-course-modal').on('show.bs.modal', function(event){
        var button = $(event.relatedTarget);  
        courseId = button.data('id');
      });
 
     //when delete course btn clicked
      btnDeleteCourse.onclick = function(){
        deleteForm.action='/courses/'+courseId+'/force?_method=DELETE';
        deleteForm.submit();
    };
    {{!-- console.log('res: '+restoreForm) --}}

    //Restore btn clicked
    restoreBtn.click(function (e) {
        e.preventDefault();
        const courseId = $(this).data('id');
          restoreForm.action = '/courses/' + courseId + '/restore?_method=PATCH';
          restoreForm.submit(); 
    });
  })
</script>